# Unzip the file [100pt]

## Question

Unzip the file

[unzip](https://github.com/AkashiSN/SECCON2015-Online-CTF/raw/master/q2/unzip)

## Answer

```bash
$ file unzip 
unzip: Zip archive data, at least v2.0 to extract

$ unzip unzip   
Archive:  unzip
[unzip] backnumber08.txt password: 
   skipping: backnumber08.txt        incorrect password
   skipping: backnumber09.txt        incorrect password
   skipping: flag                    incorrect password
```

普通に展開しようとするとパスワードがかかってるよう

ZIPの中に`flag`の他にファイルが入っているので、既知平文攻撃の可能性が高い

`backnumber08.txt`で検索してみると、

[https://2017.seccon.jp/mail-magazine/text/backnumber08.txt](https://2017.seccon.jp/mail-magazine/text/backnumber08.txt)

あったので、ダウンロードしてみる

```bash
$ wget https://2017.seccon.jp/mail-magazine/text/backnumber08.txt
```

既知平文攻撃は[pkcrack](https://www.unix-ag.uni-kl.de/~conrad/krypto/pkcrack.html)というツールでやればいいので、

```bash
$ pkcrack -h
Usage: pkcrack -c <crypted_file> -p <plaintext_file> [other_options],
where [other_options] may be one or more of
 -o <offset>	for an offset of the plaintext into the ciphertext,
			(may be negative)
 -C <c-ZIP>	where c-ZIP is a ZIP-archive containing <crypted_file>
 -P <p-ZIP>	where p-ZIP is a ZIP-archive containing <plaintext_file>
 -d <d-file>	where d-file is the name of the decrypted archive which
		will be created by this program if the correct keys are found
		(can only be used in conjunction with the -C option)
 -i	switch off case-insensitive filename matching in ZIP-archives
 -a	abort keys searching after first success
 -n	no progress indicator
```
